SELECT dm.ASSET_NO,doc_no,REFF_NO_1,REFF_NO_2,REFF_NO_3
-- SELECT *
FROM DOCUMENT_MAIN dm
join DOCUMENT_DETAIL on dm.CODE = DOCUMENT_DETAIL.DOCUMENT_CODE
JOIN FIXED_ASSET_MAIN ON FIXED_ASSET_MAIN.ASSET_NO = dm.ASSET_NO
WHERE dm.asset_no IN (
'4120036050',
'4120036051',
'4120036052',
'4120036055',
'4120036056',
'4120036057',
'4120036058',
'4120036059',
'4120036062',
'4120036064',
'4120036065',
'4120036152',
'4120036203',
'4120036364',
'4120036394',
'4120036395',
'4120036420',
'4120036466',
'4120037083',
'4120037314',
'4120037385',
'4120037387',
'4120037389',
'4120037390',
'4120037391',
'4120037392',
'4120037407',
'4120037409',
'4120037416',
'4120037420',
'4120037795',
'4120038016',
'4120038020',
'4120038030',
'4120038033',
'4120038034',
'4120038035',
'4120038043',
'4120038060',
'4120038076',
'4120038077',
'4120038079',
'4120038082',
'4120038083',
'4120038217',
'4120038218',
'4120038306',
'4120038315',
'4120038607',
'4120038670',
'4120038850',
'4120038926',
'4120039301',
'4120039700',
'4120040343',
'4120040414',
'4120040636',
'4120040642',
'4120041026',
'4120041223',
'4120041339',
'4120042149',
'4120036421',
'4120042698',
'4120042953',
'4120043231',
'4120043233',
'4120043267',
'4120043325',
'4120043392',
'4120043521',
'4120043522',
'4120043523',
'4120043524',
'4120043525',
'4120043526',
'4120043543',
'4120043544',
'4120043585',
'4120043660',
'4120043800',
'4120043831',
'4120043878',
'4120043985',
'4120044038',
'4120044040',
'4120044052',
'2008.AST.2401.00076',
'2010.AST.2409.00012',
'4120034980',
'4120034981',
'4120034982',
'4120034983',
'4120034984',
'4120034985',
'4120035014',
'4120035028',
'4120035037',
'4120035587',
'4120035588',
'4120035814',
'4120035818',
'4120035822',
'4120035823',
'4120035839',
'4120035840',
'4120035841',
'4120035902',
'4120035908',
'4120035911',
'4120035921',
'4120035925',
'4120036000',
'4120036217',
'4120038687',
'4120042840',
'4120043246',
'4120043318'
) and dm.DOCUMENT_TYPE = 'BPKB';

BEGIN TRANSACTION

----------------------------------------------------------------------------------------------------------------------------

DECLARE @asset_no VARCHAR(50), @doc_no VARCHAR(50)
DECLARE @temp TABLE (asset_no VARCHAR(50), doc_no VARCHAR(50))
INSERT INTO @temp (asset_no, doc_no)
VALUES 
('4120036050'            ,'O-01012303'),
('4120036051'            ,'O-00304898'),
('4120036052'            ,'O-00304978'),
('4120036055'            ,'O-00304982'),
('4120036056'            ,'O-00304897'),
('4120036057'            ,'O-00304900'),
('4120036058'            ,'O-00305889'),
('4120036059'            ,'O-00304979'),
('4120036062'            ,'O-00319414'),
('4120036064'            ,'O-00319416'),
('4120036065'            ,'O-00319586'),
('4120036152'            ,'Q-01809242'),
('4120036203'            ,'Q-03879258'),
('4120036364'            ,'Q-03877748'),
('4120036394'            ,'Q-05964455'),
('4120036395'            ,'Q-05964456'),
('4120036420'            ,'Q-03879876'),
('4120036466'            ,'Q-06314307'),
('4120037083'            ,'Q-00835241'),
('4120037314'            ,'Q-07910296'),
('4120037385'            ,'Q-07926067'),
('4120037387'            ,'R-00823170'),
('4120037389'            ,'P-07745240F'),
('4120037390'            ,'P-07745238F'),
('4120037391'            ,'P-07745241F'),
('4120037392'            ,'P-07745239F'),
('4120037407'            ,'S-00760952'),
('4120037409'            ,'S-00760950'),
('4120037416'            ,'R-01668037R'),
('4120037420'            ,'S-00028871'),
('4120037795'            ,'R-01357480'),
('4120038016'            ,'R-00964847'),
('4120038020'            ,'R-03043937M'),
('4120038030'            ,'R-03043936M'),
('4120038033'            ,'R-03043946M'),
('4120038034'            ,'R-03043935M'),
('4120038035'            ,'R-03043945M'),
('4120038043'            ,'Q-09854852N'),
('4120038060'            ,'Q-09924622'),
('4120038076'            ,'R-02935887M'),
('4120038077'            ,'R-02935888M'),
('4120038079'            ,'R-02935890M'),
('4120038082'            ,'R-02935878M'),
('4120038083'            ,'R-02935879M'),
('4120038217'            ,'S-03027237'),
('4120038218'            ,'S-03027236'),
('4120038306'            ,'S-00943565'),
('4120038315'            ,'S-03830232'),
('4120038607'            ,'R-02683374'),
('4120038670'            ,'S-03844147'),
('4120038850'            ,'Q-08942411'),
('4120038926'            ,'S-07283900'),
('4120039301'            ,'S-03609945'),
('4120039700'            ,'S-05399908'),
('4120040343'            ,'T-01592824'),
('4120040414'            ,'R-03066282M'),
('4120040636'            ,'S-04314456'),
('4120040642'            ,'S-04314453'),
('4120041026'            ,'S-03622218'),
('4120041223'            ,'Q-08895407'),
('4120041339'            ,'S-06676329'),
('4120042149'            ,'T-03245788I'),
('4120036421'            ,'Q-03877745'),
('4120042698'            ,'S-07107333N'),
('4120042953'            ,'S-05079107'),
('4120043231'            ,'R-03168162R'),
('4120043233'            ,'R-03168158R'),
('4120043267'            ,'U-00032057'),
('4120043325'            ,'U-06972324'),
('4120043392'            ,'S-04731490I'),
('4120043521'            ,'U-03451191'),
('4120043522'            ,'U-03451192'),
('4120043523'            ,'U-03451194'),
('4120043524'            ,'U-03451195'),
('4120043525'            ,'U-03451193'),
('4120043526'            ,'U-03456367'),
('4120043543'            ,'U-03456366'),
('4120043544'            ,'U-03456368'),
('4120043585'            ,'U-01047022'),
('4120043660'            ,'Q-01087824'),
('4120043800'            ,'Q-03940607'),
('4120043831'            ,'U-01811518'),
('4120043878'            ,'U-00764503'),
('4120043985'            ,'U-02035404N'),
('4120044038'            ,'U-01779829'),
('4120044040'            ,'U-01779882'),
('4120044052'            ,'U-01755097'),
('2008.AST.2401.00076'   ,'U-06050027'),
('2010.AST.2409.00012'   ,'U-04741282I'),
('4120034980'            ,'P-07467192'),
('4120034981'            ,'P-07467125'),
('4120034982'            ,'P-07467124'),
('4120034983'            ,'P-07467123'),
('4120034984'            ,'P-07467133'),
('4120034985'            ,'P-07467134'),
('4120035014'            ,'P-08537790'),
('4120035028'            ,'P-08559492'),
('4120035037'            ,'P-07476089'),
('4120035587'            ,'Q-00694541'),
('4120035588'            ,'Q-00694543'),
('4120035814'            ,'Q-01091954'),
('4120035818'            ,'Q-01673522'),
('4120035822'            ,'Q-01673651'),
('4120035823'            ,'Q-01676505'),
('4120035839'            ,'Q-01095503'),
('4120035840'            ,'Q-01099456'),
('4120035841'            ,'Q-01099463'),
('4120035902'            ,'Q-01682217'),
('4120035908'            ,'Q-01682219'),
('4120035911'            ,'N-04975624'),
('4120035921'            ,'N-04983426'),
('4120035925'            ,'N-04983592'),
('4120036000'            ,'Q-01683453'),
('4120036217'            ,'Q-03876746'),
('4120038687'            ,'O-00500595'),
('4120042840'            ,'Q-03879126'),
('4120043246'            ,'U-01067192'),
('4120043318'            ,'U-00167780')


WHILE EXISTS (SELECT * FROM @temp)
BEGIN
	SELECT TOP 1 @asset_no = asset_no, @doc_no = doc_no FROM @temp
	UPDATE DOCUMENT_DETAIL 
	SET doc_no = @doc_no
	WHERE document_code IN (SELECT code FROM DOCUMENT_MAIN WHERE document_type = 'BPKB' AND asset_no = @asset_no)
	DELETE FROM @temp WHERE asset_no = @asset_no
END

----------------------------------------------------------------------------------------------------------------------------
SELECT dm.ASSET_NO,doc_no,REFF_NO_1,REFF_NO_2,REFF_NO_3
FROM DOCUMENT_MAIN dm
join DOCUMENT_DETAIL on dm.CODE = DOCUMENT_DETAIL.DOCUMENT_CODE
JOIN FIXED_ASSET_MAIN ON FIXED_ASSET_MAIN.ASSET_NO = dm.ASSET_NO
WHERE dm.asset_no IN (
'4120036050',
'4120036051',
'4120036052',
'4120036055',
'4120036056',
'4120036057',
'4120036058',
'4120036059',
'4120036062',
'4120036064',
'4120036065',
'4120036152',
'4120036203',
'4120036364',
'4120036394',
'4120036395',
'4120036420',
'4120036466',
'4120037083',
'4120037314',
'4120037385',
'4120037387',
'4120037389',
'4120037390',
'4120037391',
'4120037392',
'4120037407',
'4120037409',
'4120037416',
'4120037420',
'4120037795',
'4120038016',
'4120038020',
'4120038030',
'4120038033',
'4120038034',
'4120038035',
'4120038043',
'4120038060',
'4120038076',
'4120038077',
'4120038079',
'4120038082',
'4120038083',
'4120038217',
'4120038218',
'4120038306',
'4120038315',
'4120038607',
'4120038670',
'4120038850',
'4120038926',
'4120039301',
'4120039700',
'4120040343',
'4120040414',
'4120040636',
'4120040642',
'4120041026',
'4120041223',
'4120041339',
'4120042149',
'4120036421',
'4120042698',
'4120042953',
'4120043231',
'4120043233',
'4120043267',
'4120043325',
'4120043392',
'4120043521',
'4120043522',
'4120043523',
'4120043524',
'4120043525',
'4120043526',
'4120043543',
'4120043544',
'4120043585',
'4120043660',
'4120043800',
'4120043831',
'4120043878',
'4120043985',
'4120044038',
'4120044040',
'4120044052',
'2008.AST.2401.00076',
'2010.AST.2409.00012',
'4120034980',
'4120034981',
'4120034982',
'4120034983',
'4120034984',
'4120034985',
'4120035014',
'4120035028',
'4120035037',
'4120035587',
'4120035588',
'4120035814',
'4120035818',
'4120035822',
'4120035823',
'4120035839',
'4120035840',
'4120035841',
'4120035902',
'4120035908',
'4120035911',
'4120035921',
'4120035925',
'4120036000',
'4120036217',
'4120038687',
'4120042840',
'4120043246',
'4120043318'
) and dm.DOCUMENT_TYPE = 'BPKB';

ROLLBACK TRANSACTION;

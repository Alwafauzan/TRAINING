BEGIN TRANSACTION 


SELECT	BILLING_DATE,ASSET_NO 
FROM	dbo.AGREEMENT_ASSET_AMORTIZATION
WHERE	AGREEMENT_NO	= '0002983.4.38.10.2024' AND BILLING_NO >= 2 AND BILLING_NO <= 61
AND		ASSET_NO in ('2038.OPLAA.2407.000070', '2038.OPLAA.2407.000071') 
ORDER BY ASSET_NO ASC

SELECT	BILLING_DATE,ASSET_NO FROM dbo.AGREEMENT_ASSET_AMORTIZATION
WHERE	AGREEMENT_NO	= '0002983.4.38.10.2024' AND BILLING_NO >= 4 AND BILLING_NO <= 61
AND		ASSET_NO in ( '2038.OPLAA.2407.000081','2038.OPLAA.2408.000020') 
ORDER BY ASSET_NO ASC

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= DATEADD(DAY,1,BILLING_DATE)
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO >= 2 AND BILLING_NO < 61 AND ASSET_NO = '2038.OPLAA.2407.000070'

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= '02/01/2030'
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO = 61 AND ASSET_NO = '2038.OPLAA.2407.000070'

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= DATEADD(DAY,1,BILLING_DATE)
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO >= 2 AND BILLING_NO < 61 AND ASSET_NO = '2038.OPLAA.2407.000071'

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= '02/01/2030'
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO = 61 AND ASSET_NO = '2038.OPLAA.2407.000071'

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= DATEADD(DAY,1,BILLING_DATE) 
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO >= 4 AND BILLING_NO < 61 AND ASSET_NO = '2038.OPLAA.2407.000081'
	
UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= '12/01/2029'
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO = 61 AND ASSET_NO = '2038.OPLAA.2407.000081'

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= DATEADD(DAY,1,BILLING_DATE)
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO >= 4 AND BILLING_NO < 61 AND ASSET_NO = '2038.OPLAA.2408.000020'

UPDATE	dbo.AGREEMENT_ASSET_AMORTIZATION
SET		BILLING_DATE		= '12/01/2029'
		,mod_date           = GETDATE()
		,mod_by             = 'MTN_FAUZAN'
		,mod_ip_address     = 'MYFORM-524188'
WHERE	AGREEMENT_NO		= '0002983.4.38.10.2024' AND BILLING_NO = 61 AND ASSET_NO = '2038.OPLAA.2408.000020'


SELECT	BILLING_DATE,ASSET_NO 
FROM	dbo.AGREEMENT_ASSET_AMORTIZATION
WHERE	AGREEMENT_NO	= '0002983.4.38.10.2024' AND BILLING_NO >= 2 AND BILLING_NO <= 61
AND		ASSET_NO in ('2038.OPLAA.2407.000070', '2038.OPLAA.2407.000071') 
ORDER BY ASSET_NO ASC

SELECT BILLING_DATE,ASSET_NO 
FROM dbo.AGREEMENT_ASSET_AMORTIZATION
WHERE AGREEMENT_NO	= '0002983.4.38.10.2024' AND BILLING_NO >= 4 AND BILLING_NO <= 61
AND ASSET_NO in ( '2038.OPLAA.2407.000081','2038.OPLAA.2408.000020') 
ORDER BY ASSET_NO ASC



DECLARE @asset_no CURSOR;
SET @asset_no = CURSOR FOR
SELECT asset_no FROM dbo.AGREEMENT_ASSET WHERE FA_REFF_NO_01 IN ('L8231NF','B9537PXA','L8063NF','L8064NF')

OPEN @asset_no
DECLARE @asset_no_var VARCHAR(50)
FETCH NEXT FROM @asset_no INTO @asset_no_var

WHILE @@FETCH_STATUS = 0
BEGIN
  -- Insert rows into table 'TableName'
  INSERT INTO MTN_DATA_DSF_LOG
  ( -- columns to insert data into
   MAINTENANCE_NAME
   ,REMARK
   ,TABEL_UTAMA
   ,REFF_1
   ,REFF_2
   ,REFF_3
   ,CRE_DATE
   ,CRE_BY
  )
  VALUES
  ( -- first row: values for the columns in the list above
  'MTN MyForm 522791'
  ,'Revisi billing date untuk kontrak 0002983/4/38/10/2024'
  ,'AGREEMENT_ASSET_AMORTIZATION'
  ,@asset_no_var
  ,null
  ,null
  ,GETDATE()
  ,'fauzan'
  );

  FETCH NEXT FROM @asset_no INTO @asset_no_var
END

CLOSE @asset_no
DEALLOCATE @asset_no


ROLLBACK TRANSACTION 